<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Inventory | Admin</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/styles/admin.css">
</head>
<body class="admin-body">
  <%- include('admin-navbar') %>

  <div class="admin-container">
    <div class="admin-title">Inventory Management</div>
    <div class="admin-subtitle">Monitor stock levels, update products, and manage availability.</div>

    <div class="d-flex justify-content-end mt-3">
      <a href="/admin/add-product" class="admin-btn admin-btn-primary">+ Add Product</a>
    </div>

    <div class="admin-card mt-3">
      <form method="GET" action="/admin/inventory" class="row g-3 mb-3">
        <div class="col-md-4">
          <select class="form-select" name="category">
            <option value="">All Categories</option>
            <option value="Bunnies" <%= category === 'Bunnies' ? 'selected' : '' %>>Bunnies</option>
            <option value="Animals" <%= category === 'Animals' ? 'selected' : '' %>>Animals</option>
            <option value="Amuseables" <%= category === 'Amuseables' ? 'selected' : '' %>>Amuseables</option>
            <option value="Retired" <%= category === 'Retired' ? 'selected' : '' %>>Retired</option>
            <option value="Charms" <%= category === 'Charms' ? 'selected' : '' %>>Charms</option>
            <option value="Merchandise" <%= category === 'Merchandise' ? 'selected' : '' %>>Merchandise</option>
          </select>
        </div>
        <div class="col-md-4">
          <select name="lowFirst" class="form-select">
            <option value="">Sort A-Z</option>
            <option value="1" <%= lowFirst ? 'selected' : '' %>>Prioritise Low Stock</option>
          </select>
        </div>
        <div class="col-md-4 d-grid">
          <button type="submit" class="admin-btn admin-btn-secondary">Apply Filters</button>
        </div>
      </form>

      <div class="table-responsive admin-table">
        <table class="table table-hover align-middle mb-0">
          <thead>
            <tr>
              <th>Image</th>
              <th>Product</th>
              <th>Qty</th>
              <th>Price</th>
              <th>Status</th>
              <th>Edit</th>
              <th>Delete</th>
            </tr>
          </thead>
          <tbody>
            <% products.forEach(p => { %>
              <tr>
                <td><img src="/images/<%= p.image %>" width="60" class="rounded"></td>
                <td><strong><%= p.productName %></strong></td>
                <td><%= p.quantity %></td>
                <td>$<%= Number(p.price).toFixed(2) %></td>
                <td>
                  <% if (p.quantity < 20) { %>
                    <span class="admin-badge admin-badge-danger">Low</span>
                  <% } else if (p.quantity < 50) { %>
                    <span class="admin-badge admin-badge-warn">Medium</span>
                  <% } else { %>
                    <span class="admin-badge admin-badge-success">Healthy</span>
                  <% } %>
                </td>
                <td>
                  <a href="/admin/update-product/<%= p.id %>" class="admin-btn admin-btn-secondary">Edit</a>
                </td>
                <td>
                  <a href="/admin/delete-product/<%= p.id %>" class="admin-btn admin-btn-danger" onclick="return confirm('Delete this product?')">Delete</a>
                </td>
              </tr>
            <% }) %>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</body>
</html>
