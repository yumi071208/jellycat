<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Vouchers | Admin</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/styles/admin.css">
</head>
<body class="admin-body">
  <%- include('admin-navbar') %>

  <div class="admin-container">
    <div class="admin-title">Voucher Management</div>
    <div class="admin-subtitle">Create and manage promotions.</div>

    <div class="d-flex justify-content-end mt-3">
      <a href="/admin/vouchers/add" class="admin-btn admin-btn-primary">+ Add Voucher</a>
    </div>

    <div class="admin-card mt-3">
      <div class="table-responsive admin-table">
        <table class="table table-bordered table-striped align-middle mb-0 text-center">
          <thead>
            <tr>
              <th>Code</th>
              <th>Type</th>
              <th>Amount</th>
              <th>Minimum Spend</th>
              <th>Expiry</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <% if (vouchers && vouchers.length > 0) { %>
              <% vouchers.forEach(v => { %>
                <tr>
                  <td><%= v.code %></td>
                  <td><%= v.type %></td>
                  <td>
                    <% if (v.type === 'percent') { %>
                      <%= Number(v.amount).toFixed(2) %>%
                    <% } else { %>
                      $<%= Number(v.amount).toFixed(2) %>
                    <% } %>
                  </td>
                  <td>$<%= Number(v.minSpend).toFixed(2) %></td>
                  <td>
                    <% if (v.expire_at) { %>
                      <%= new Date(v.expire_at).toISOString().split('T')[0] %>
                    <% } else { %>
                      N/A
                    <% } %>
                  </td>
                  <td>
                    <a href="/admin/vouchers/edit/<%= v.id %>" class="admin-btn admin-btn-secondary">Edit</a>
                    <a href="/admin/vouchers/delete/<%= v.id %>" class="admin-btn admin-btn-danger" onclick="return confirm('Delete this voucher?')">Delete</a>
                  </td>
                </tr>
              <% }) %>
            <% } else { %>
              <tr>
                <td colspan="6" class="text-center text-muted">No vouchers found</td>
              </tr>
            <% } %>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</body>
</html>
