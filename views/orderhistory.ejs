<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>My Orders | JellyMart</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/styles/theme.css">
</head>

<body>
  <%- include('navbar') %>

  <div class="container my-5">
    <div class="orders-hero mb-4">
      <div class="section-title">
        <span>Orders</span>
      </div>
      <p class="text-muted mb-0">Track your recent purchases and reorder anytime.</p>
    </div>

    <% if (!orders || orders.length === 0) { %>
      <div class="layout-card text-center">
        <p class="mb-3">You have no past purchases.</p>
        <a href="/shopping" class="pastel-btn">Start Shopping</a>
      </div>
    <% } else { %>
      <div class="order-list">
        <% 
          const thumbs = [
            '/images/apples.png',
            '/images/bananas.png',
            '/images/bread.png',
            '/images/broccoli.png',
            '/images/greentea.png',
            '/images/milk.png'
          ];
        %>
        <% orders.forEach((order, index) => { %>
          <% const status = order.status || 'Complete'; %>
          <div class="order-card">
            <div class="order-thumb">
              <img src="<%= thumbs[index % thumbs.length] %>" alt="Order item">
            </div>
            <div class="order-meta">
              <div class="order-status"><%= status %></div>
              <div class="order-date"><%= new Date(order.created_at).toLocaleDateString() %></div>
              <div class="order-id">Order #<%= order.id %></div>
              <div class="order-total">$<%= Number(order.total).toFixed(2) %> SGD</div>
            </div>
            <div class="order-actions">
              <a class="pastel-btn text-center" href="/invoice/<%= order.id %>">View Invoice</a>
              <a class="pastel-secondary-btn text-center" href="/reorder/<%= order.id %>">Reorder</a>
            </div>
          </div>
        <% }) %>
      </div>
    <% } %>
  </div>
</body>
</html>
